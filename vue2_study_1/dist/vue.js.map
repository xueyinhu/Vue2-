{"version":3,"file":"vue.js","sources":["../src/compile/index.js","../src/observe/arr.js","../src/observe/index.js","../src/initState.js","../src/init.js","../src/index.js"],"sourcesContent":["const ncname = `[a-zA-Z][\\\\-\\\\.0-9_a-zA-Z]*`\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\r\nconst startTagOpen = new RegExp(`<${qnameCapture}`)\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\r\nconst startTagClose = /^\\s*(\\/?)>/\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\n\r\nfunction parseHTML(html) {\r\n    while(html) {\r\n        let textEnd = html.indexOf('<')\r\n        if (textEnd === 0) {\r\n            const startTagMatch = parseStartTag()\r\n        }\r\n    }\r\n    function parseStartTag() {\r\n    }\r\n}\r\n\r\nexport function compileToFunction(el) {\r\n    let ast = parseHTML(template)\r\n}","let oldArrayProtoMethods = Array.prototype\r\nexport let ArrayMethods = Object.create(oldArrayProtoMethods)\r\n\r\nlet methods = [\r\n    'push',\r\n    'pop',\r\n    'unshirt',\r\n    'shirt',\r\n    'splice'\r\n]\r\n\r\nmethods.forEach(item => {\r\n    ArrayMethods[item] = function(...args) {\r\n        let result = oldArrayProtoMethods[item].apply(this, args)\r\n        let inserted\r\n        switch (item) {\r\n            case 'push':\r\n            case 'unsshift':\r\n                inserted = args\r\n                break\r\n            case 'splice':\r\n                inserted = args.splice(2)\r\n                break\r\n        }\r\n        let ob = this.__ob__\r\n        if(inserted) {\r\n            ob.observeArray(inserted)\r\n        }\r\n        return result\r\n    }\r\n})\r\n\r\n","import { ArrayMethods } from \"./arr\"\r\n\r\nexport function observer(data) {\r\n    if(typeof data != 'object' || data == null) {\r\n        return data\r\n    }\r\n    return new Observer(data)\r\n}\r\n\r\nclass Observer {\r\n    constructor(data) {\r\n        Object.defineProperty(data, \"__ob__\", {\r\n            enumerable: false,\r\n            value: this\r\n        })\r\n        if(Array.isArray(data)) {\r\n            data.__proto__ = ArrayMethods\r\n            this.observeArray(data)\r\n        } else {\r\n            this.work(data)\r\n        }\r\n    }\r\n    work(data) {\r\n        let keys = Object.keys(data)\r\n        for(let i=0; i<keys.length; i++) {\r\n            let key = keys[i]\r\n            let value = data[key]\r\n            defineReactive(data, key, value)\r\n        }\r\n    }\r\n    observeArray(data) {\r\n        for (let i = 0; i < data.length; i++) {\r\n            observer(data[i])\r\n        }\r\n    }\r\n}\r\n\r\nfunction defineReactive(data, key, value) {\r\n    observer(value)\r\n    Object.defineProperty(data, key, {\r\n        get() {\r\n            return value\r\n        },\r\n        set(newValue) {\r\n            if (newValue == value) return\r\n            observer(newValue)\r\n            value = newValue\r\n        }\r\n    })\r\n}\r\n\r\n","import { observer } from \"./observe/index\"\r\n\r\nexport function initState(vm) {\r\n    let opts = vm.$options\r\n    if (opts.data) {\r\n        initData(vm)\r\n    }\r\n}\r\n\r\nfunction initData(vm) {\r\n    let data = vm.$options.data\r\n    data = vm._data = typeof data == 'function' ? data.call(vm) : data\r\n    // 数据代理\r\n    for(let key in data) {\r\n        proxy(vm, '_data', key)\r\n    }\r\n    // 数据劫持\r\n    observer(data)\r\n}\r\n\r\nfunction proxy(vm, source, key) {\r\n    Object.defineProperty(vm, key, {\r\n        get() {\r\n            return vm[source][key]\r\n        },\r\n        set(newValue) {\r\n            vm[source][key] = newValue\r\n        }\r\n    })\r\n}\r\n","import { compileToFunction } from \"./compile/index\"\r\nimport { initState } from \"./initState\"\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function(options) {\r\n        let vm  = this\r\n        vm.$options = options\r\n        // 初始化状态\r\n        initState(vm)\r\n        // 渲染模板\r\n        if(vm.$options.el) {\r\n            vm.$mount(vm.$options.el)\r\n        }\r\n    }\r\n\r\n    Vue.prototype.$mount = function(el) {\r\n        let vm = this\r\n        let options = vm.$options\r\n        el = document.querySelector(el)\r\n        if(!options.render) {\r\n            let template = options.template\r\n            if (!template && el) {\r\n                el = el.outerHTML\r\n                let ast = compileToFunction(el)\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n","import { initMixin } from \"./init\"\r\n\r\nfunction Vue(options) {\r\n    // 初始化\r\n    this._init(options)\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nexport default Vue"],"names":["parseHTML","html","indexOf","compileToFunction","el","template","oldArrayProtoMethods","Array","prototype","ArrayMethods","Object","create","methods","forEach","item","_len","arguments","length","args","_key","result","apply","inserted","splice","ob","__ob__","observeArray","observer","data","_typeof","Observer","_classCallCheck","defineProperty","enumerable","value","isArray","__proto__","work","_createClass","key","keys","i","defineReactive","get","set","newValue","initState","vm","opts","$options","initData","_data","call","proxy","source","initMixin","Vue","_init","options","$mount","document","querySelector","render","outerHTML"],"mappings":";;;;;;IAQA,SAASA,SAASA,CAACC,IAAI,EAAE;IACrB,EAAA,OAAMA,IAAI,EAAE;IACR,IAAcA,IAAI,CAACC,OAAO,CAAC,GAAG,EAAC;IAInC,GAAA;IAGJ,CAAA;IAEO,SAASC,iBAAiBA,CAACC,EAAE,EAAE;IAClC,EAAUJ,SAAS,CAACK,QAAQ,EAAC;IACjC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICrBA,IAAIC,oBAAoB,GAAGC,KAAK,CAACC,SAAS,CAAA;IACnC,IAAIC,YAAY,GAAGC,MAAM,CAACC,MAAM,CAACL,oBAAoB,CAAC,CAAA;IAE7D,IAAIM,OAAO,GAAG,CACV,MAAM,EACN,KAAK,EACL,SAAS,EACT,OAAO,EACP,QAAQ,CACX,CAAA;IAEDA,OAAO,CAACC,OAAO,CAAC,UAAAC,IAAI,EAAI;IACpBL,EAAAA,YAAY,CAACK,IAAI,CAAC,GAAG,YAAkB;IAAA,IAAA,KAAA,IAAAC,IAAA,GAAAC,SAAA,CAAAC,MAAA,EAANC,IAAI,GAAAX,IAAAA,KAAA,CAAAQ,IAAA,GAAAI,IAAA,GAAA,CAAA,EAAAA,IAAA,GAAAJ,IAAA,EAAAI,IAAA,EAAA,EAAA;IAAJD,MAAAA,IAAI,CAAAC,IAAA,CAAAH,GAAAA,SAAA,CAAAG,IAAA,CAAA,CAAA;IAAA,KAAA;IACjC,IAAA,IAAIC,MAAM,GAAGd,oBAAoB,CAACQ,IAAI,CAAC,CAACO,KAAK,CAAC,IAAI,EAAEH,IAAI,CAAC,CAAA;IACzD,IAAA,IAAII,QAAQ,CAAA;IACZ,IAAA,QAAQR,IAAI;IACR,MAAA,KAAK,MAAM,CAAA;IACX,MAAA,KAAK,UAAU;IACXQ,QAAAA,QAAQ,GAAGJ,IAAI,CAAA;IACf,QAAA,MAAA;IACJ,MAAA,KAAK,QAAQ;IACTI,QAAAA,QAAQ,GAAGJ,IAAI,CAACK,MAAM,CAAC,CAAC,CAAC,CAAA;IACzB,QAAA,MAAA;IAAK,KAAA;IAEb,IAAA,IAAIC,EAAE,GAAG,IAAI,CAACC,MAAM,CAAA;IACpB,IAAA,IAAGH,QAAQ,EAAE;IACTE,MAAAA,EAAE,CAACE,YAAY,CAACJ,QAAQ,CAAC,CAAA;IAC7B,KAAA;IACA,IAAA,OAAOF,MAAM,CAAA;OAChB,CAAA;IACL,CAAC,CAAC;;IC5BK,SAASO,QAAQA,CAACC,IAAI,EAAE;MAC3B,IAAGC,OAAA,CAAOD,IAAI,CAAA,IAAI,QAAQ,IAAIA,IAAI,IAAI,IAAI,EAAE;IACxC,IAAA,OAAOA,IAAI,CAAA;IACf,GAAA;IACA,EAAA,OAAO,IAAIE,QAAQ,CAACF,IAAI,CAAC,CAAA;IAC7B,CAAA;IAAC,IAEKE,QAAQ,gBAAA,YAAA;MACV,SAAAA,QAAAA,CAAYF,IAAI,EAAE;IAAAG,IAAAA,eAAA,OAAAD,QAAA,CAAA,CAAA;IACdpB,IAAAA,MAAM,CAACsB,cAAc,CAACJ,IAAI,EAAE,QAAQ,EAAE;IAClCK,MAAAA,UAAU,EAAE,KAAK;IACjBC,MAAAA,KAAK,EAAE,IAAA;IACX,KAAC,CAAC,CAAA;IACF,IAAA,IAAG3B,KAAK,CAAC4B,OAAO,CAACP,IAAI,CAAC,EAAE;UACpBA,IAAI,CAACQ,SAAS,GAAG3B,YAAY,CAAA;IAC7B,MAAA,IAAI,CAACiB,YAAY,CAACE,IAAI,CAAC,CAAA;IAC3B,KAAC,MAAM;IACH,MAAA,IAAI,CAACS,IAAI,CAACT,IAAI,CAAC,CAAA;IACnB,KAAA;IACJ,GAAA;IAACU,EAAAA,YAAA,CAAAR,QAAA,EAAA,CAAA;QAAAS,GAAA,EAAA,MAAA;IAAAL,IAAAA,KAAA,EACD,SAAAG,IAAKT,CAAAA,IAAI,EAAE;IACP,MAAA,IAAIY,IAAI,GAAG9B,MAAM,CAAC8B,IAAI,CAACZ,IAAI,CAAC,CAAA;IAC5B,MAAA,KAAI,IAAIa,CAAC,GAAC,CAAC,EAAEA,CAAC,GAACD,IAAI,CAACvB,MAAM,EAAEwB,CAAC,EAAE,EAAE;IAC7B,QAAA,IAAIF,GAAG,GAAGC,IAAI,CAACC,CAAC,CAAC,CAAA;IACjB,QAAA,IAAIP,KAAK,GAAGN,IAAI,CAACW,GAAG,CAAC,CAAA;IACrBG,QAAAA,cAAc,CAACd,IAAI,EAAEW,GAAG,EAAEL,KAAK,CAAC,CAAA;IACpC,OAAA;IACJ,KAAA;IAAC,GAAA,EAAA;QAAAK,GAAA,EAAA,cAAA;IAAAL,IAAAA,KAAA,EACD,SAAAR,YAAaE,CAAAA,IAAI,EAAE;IACf,MAAA,KAAK,IAAIa,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGb,IAAI,CAACX,MAAM,EAAEwB,CAAC,EAAE,EAAE;IAClCd,QAAAA,QAAQ,CAACC,IAAI,CAACa,CAAC,CAAC,CAAC,CAAA;IACrB,OAAA;IACJ,KAAA;IAAC,GAAA,CAAA,CAAA,CAAA;IAAA,EAAA,OAAAX,QAAA,CAAA;IAAA,CAAA,EAAA,CAAA;IAGL,SAASY,cAAcA,CAACd,IAAI,EAAEW,GAAG,EAAEL,KAAK,EAAE;MACtCP,QAAQ,CAACO,KAAK,CAAC,CAAA;IACfxB,EAAAA,MAAM,CAACsB,cAAc,CAACJ,IAAI,EAAEW,GAAG,EAAE;QAC7BI,GAAG,EAAA,SAAAA,MAAG;IACF,MAAA,OAAOT,KAAK,CAAA;SACf;QACDU,GAAG,EAAA,SAAAA,GAACC,CAAAA,QAAQ,EAAE;UACV,IAAIA,QAAQ,IAAIX,KAAK,EAAE,OAAA;UACvBP,QAAQ,CAACkB,QAAQ,CAAC,CAAA;IAClBX,MAAAA,KAAK,GAAGW,QAAQ,CAAA;IACpB,KAAA;IACJ,GAAC,CAAC,CAAA;IACN;;IC/CO,SAASC,SAASA,CAACC,EAAE,EAAE;IAC1B,EAAA,IAAIC,IAAI,GAAGD,EAAE,CAACE,QAAQ,CAAA;MACtB,IAAID,IAAI,CAACpB,IAAI,EAAE;QACXsB,QAAQ,CAACH,EAAE,CAAC,CAAA;IAChB,GAAA;IACJ,CAAA;IAEA,SAASG,QAAQA,CAACH,EAAE,EAAE;IAClB,EAAA,IAAInB,IAAI,GAAGmB,EAAE,CAACE,QAAQ,CAACrB,IAAI,CAAA;IAC3BA,EAAAA,IAAI,GAAGmB,EAAE,CAACI,KAAK,GAAG,OAAOvB,IAAI,IAAI,UAAU,GAAGA,IAAI,CAACwB,IAAI,CAACL,EAAE,CAAC,GAAGnB,IAAI,CAAA;IAClE;IACA,EAAA,KAAI,IAAIW,GAAG,IAAIX,IAAI,EAAE;IACjByB,IAAAA,KAAK,CAACN,EAAE,EAAE,OAAO,EAAER,GAAG,CAAC,CAAA;IAC3B,GAAA;IACA;MACAZ,QAAQ,CAACC,IAAI,CAAC,CAAA;IAClB,CAAA;IAEA,SAASyB,KAAKA,CAACN,EAAE,EAAEO,MAAM,EAAEf,GAAG,EAAE;IAC5B7B,EAAAA,MAAM,CAACsB,cAAc,CAACe,EAAE,EAAER,GAAG,EAAE;QAC3BI,GAAG,EAAA,SAAAA,MAAG;IACF,MAAA,OAAOI,EAAE,CAACO,MAAM,CAAC,CAACf,GAAG,CAAC,CAAA;SACzB;QACDK,GAAG,EAAA,SAAAA,GAACC,CAAAA,QAAQ,EAAE;IACVE,MAAAA,EAAE,CAACO,MAAM,CAAC,CAACf,GAAG,CAAC,GAAGM,QAAQ,CAAA;IAC9B,KAAA;IACJ,GAAC,CAAC,CAAA;IACN;;IC1BO,SAASU,SAASA,CAACC,GAAG,EAAE;IAC3BA,EAAAA,GAAG,CAAChD,SAAS,CAACiD,KAAK,GAAG,UAASC,OAAO,EAAE;QACpC,IAAIX,EAAE,GAAI,IAAI,CAAA;QACdA,EAAE,CAACE,QAAQ,GAAGS,OAAO,CAAA;IACrB;QACAZ,SAAS,CAACC,EAAE,CAAC,CAAA;IACb;IACA,IAAA,IAAGA,EAAE,CAACE,QAAQ,CAAC7C,EAAE,EAAE;UACf2C,EAAE,CAACY,MAAM,CAACZ,EAAE,CAACE,QAAQ,CAAC7C,EAAE,CAAC,CAAA;IAC7B,KAAA;OACH,CAAA;IAEDoD,EAAAA,GAAG,CAAChD,SAAS,CAACmD,MAAM,GAAG,UAASvD,EAAE,EAAE;QAChC,IAAI2C,EAAE,GAAG,IAAI,CAAA;IACb,IAAA,IAAIW,OAAO,GAAGX,EAAE,CAACE,QAAQ,CAAA;IACzB7C,IAAAA,EAAE,GAAGwD,QAAQ,CAACC,aAAa,CAACzD,EAAE,CAAC,CAAA;IAC/B,IAAA,IAAG,CAACsD,OAAO,CAACI,MAAM,EAAE;IAChB,MAAA,IAAIzD,QAAQ,GAAGqD,OAAO,CAACrD,QAAQ,CAAA;IAC/B,MAAA,IAAI,CAACA,QAAQ,IAAID,EAAE,EAAE;YACjBA,EAAE,GAAGA,EAAE,CAAC2D,SAAS,CAAA;IACjB,QAAU5D,iBAAiB,CAAG,EAAC;IACnC,OAAA;IACJ,KAAA;OACH,CAAA;IACL;;ICzBA,SAASqD,GAAGA,CAACE,OAAO,EAAE;IAClB;IACA,EAAA,IAAI,CAACD,KAAK,CAACC,OAAO,CAAC,CAAA;IACvB,CAAA;IAEAH,SAAS,CAACC,GAAG,CAAC;;;;;;;;"}